(()=>{"use strict";var e={pipeTimer:100,timer:0,simulatedNNs:500,fitnessDictionary:{},NNKeepers:50,NNBrain:[4,8,8,8,6,4,1],bestNNs:{},mousePos:{},mutationRateMutationRate:.3,mutationMutationAmount:2,checkpoints:[[208,208],[489,122],[697,132],[907,196],[920,394],[794,481],[550,494],[350,466],[261,349],[453,292],[580,374]],checkpointSize:50,timerLimit:1e4,delay:20,human:!0,generationNum:0},r=document.querySelector("canvas");r.width=window.innerWidth,r.height=window.innerHeight;var t=r.getContext("2d"),i={Flappies:[],Pipes:[],Cars:[],NNs:[],Barrier:[]},n={};window.onkeyup=function(e){n[e.keyCode]=!1},window.onkeydown=function(e){n[e.keyCode]=!0};var o=document.getElementById("checkbox"),c=document.getElementById("rangeValue"),s=document.querySelector("#range");null!=o&&o.addEventListener("keydown",(function(e){32===e.keyCode&&e.preventDefault()})),null!=s&&null!=c&&(s.addEventListener("change",(function(r){c.innerHTML=s.value+" Simulation Speed",e.delay=20-.02*parseInt(s.value)})),s.addEventListener("mousemove",(function(r){c.innerHTML=s.value+" Simulation Speed",e.delay=20-.02*parseInt(s.value)})));var a=function(){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.vectors=e}return e.prototype.draw=function(){t.strokeStyle="black",t.lineWidth=5,t.beginPath();for(var e=0;e<this.vectors.length;e++){t.moveTo(this.vectors[e][0][0],this.vectors[e][0][1]);for(var r=1;r<this.vectors[e].length;r++)t.lineTo(this.vectors[e][r][0],this.vectors[e][r][1]);t.stroke()}},e}();r.addEventListener("mousemove",(function(t){var i=r.getBoundingClientRect();e.mousePos={x:t.clientX-i.left,y:t.clientY-i.top}})),i.Barrier=[],i.Barrier.push(new a([])),e.checkpoints=[];var l="barrier",h=[];r.addEventListener("click",(function(){if("barrier"===l){i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].push([e.mousePos.x,e.mousePos.y]);for(var r="",n=0;n<i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length;n++)r=r+"["+i.Barrier[0].vectors[i.Barrier[0].vectors.length-1][n][0]+","+i.Barrier[0].vectors[i.Barrier[0].vectors.length-1][n][1]+"], ";i.Barrier[0].draw(),t.fillStyle="black",t.fillRect(i.Barrier[0].vectors[i.Barrier[0].vectors.length-1][i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length-1][0]-5,i.Barrier[0].vectors[i.Barrier[0].vectors.length-1][i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length-1][1]-5,10,10),console.log(r),h.push("barrier")}if("checkpoint"===l){e.checkpoints.push([e.mousePos.x,e.mousePos.y]);for(n=0;n<e.checkpoints.length;n++)t.fillStyle="green",t.lineWidth=0,t.fillRect(e.checkpoints[n][0]-e.checkpointSize/4,e.checkpoints[n][1]-e.checkpointSize/4,e.checkpointSize/2,e.checkpointSize/2),console.log(e.checkpoints[n]);h.push("checkpoint")}})),document.addEventListener("keydown",(function(n){if("l"===n.key&&(l="barrier",i.Barrier[0].vectors.push([])),"b"===n.key&&(l="barrier"),"c"===n.key&&(l="checkpoint"),"s"===n.key&&(localStorage.setItem("barrier",JSON.stringify(i.Barrier[0].vectors)),localStorage.setItem("checkpoint",JSON.stringify(e.checkpoints)),window.location.href="./customSimulation.html"),"u"===n.key){"barrier"===h[h.length-1]?(h.splice(h.length-1,1),0===i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length&&0!==i.Barrier[0].vectors.length&&i.Barrier[0].vectors.splice(i.Barrier[0].vectors.length-1,1),i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].splice(i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length-1,1),0===i.Barrier[0].vectors[i.Barrier[0].vectors.length-1].length&&0!==i.Barrier[0].vectors.length&&i.Barrier[0].vectors.splice(i.Barrier[0].vectors.length-1,1)):"checkpoint"===h[h.length-1]&&(h.splice(h.length-1,1),e.checkpoints.splice(e.checkpoints.length-1,1)),t.clearRect(0,0,r.width,r.height),i.Barrier[0].draw();for(var o=0;o<e.checkpoints.length;o++)t.fillStyle="green",t.lineWidth=0,t.fillRect(e.checkpoints[o][0]-e.checkpointSize/4,e.checkpoints[o][1]-e.checkpointSize/4,e.checkpointSize/2,e.checkpointSize/2),console.log(e.checkpoints[o])}}))})();